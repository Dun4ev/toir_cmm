# Генератор CMM файлов

**Ссылка на репозиторий: [github.com/Dun4ev/toir_cmm](https://github.com/Dun4ev/toir_cmm)**

## 1. Назначение

Утилита для автоматического создания "Листа комментариев" (`_CMM.xlsx`) на основе шаблона. 

Программа обрабатывает файлы отчетов (`.docx`, `.pdf`) в выбранной папке, извлекает из их имени индекс (например, `I.7.4`), находит по этому индексу описание в файле-справочнике и заполняет итоговый Excel-файл.

## 2. Как использовать (для пользователей)

Программа поставляется в виде одного исполняемого файла `toir_cmm.exe`, который не требует установки.

1.  Скачайте `toir_cmm.exe` из папки `dist` последнего релиза.
2.  Запустите файл.
3.  Сразу появится диалоговое окно для выбора папки. Выберите папку, содержащую ваши файлы отчетов.
4.  Дождитесь появления окна с сообщением о завершении обработки.
5.  Готовые `_CMM.xlsx` файлы появятся в той же папке, где лежали исходные отчеты.

## 3. Для разработчиков

### 3.1. Настройка окружения

Для внесения изменений в код или пересборки `.exe` файла с нуля выполните следующие шаги.

1.  **Клонируйте репозиторий и перейдите в его папку.**
2.  **Создайте и активируйте виртуальное окружение:**
    ```bash
    # Создание
    python -m venv .venv
    # Активация (Windows)
    .venv\Scripts\activate
    ```
3.  **Установите все необходимые зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

### 3.2. Запуск из исходников

Для запуска скрипта без сборки в `.exe` выполните:
```bash
python toir_cmm.py
```

### 3.3. Сборка `.exe` файла

В репозитории уже есть настроенный файл `toir_cmm.spec`. Он включает в себя:
- Сборку в один файл (`--onefile`).
- Встраивание папки `Template` с шаблонами внутрь `.exe`.
- Поддержку `tkinter` и `openpyxl`.

Для сборки просто выполните команду:
```bash
pyinstaller toir_cmm.spec
```
Готовый, полностью автономный `toir_cmm.exe` появится в папке `dist`.

## 4. Структура проекта

```
.../toir_cmm/
├── .venv/                   # Виртуальное окружение
├── dist/                    # Папка с готовым .exe файлом
├── build/                   # Временная папка PyInstaller
├── Template/
│   ├── TZ_glob.xlsx         # Файл-справочник с индексами
│   └── CommentSheet_Template.xltx # Шаблон для листа комментариев
├── toir_cmm.py              # Основной скрипт программы
├── toir_cmm.spec            # Файл конфигурации для сборки .exe
└── requirements.txt         # Список зависимостей проекта
```
